version: "3.9"

services:
  redis:
    image: redis:7
    container_name: ray-service-redis
    restart: unless-stopped
    ports:
      - "6379:6379"
    volumes:
      - redis-data:/data

  ray-service:
    build: .
    # image: your-registry/ray-service:latest
    container_name: ray-service-app
    depends_on:
      - redis
    environment:
      REDIS_URL: ${REDIS_URL:-redis://ray-service-redis:6379/0}
      SERVICE_HOST: ${SERVICE_HOST:-0.0.0.0}
      SERVICE_PORT: ${SERVICE_PORT:-8000}
      HEARTBEAT_INTERVAL_SECONDS: ${HEARTBEAT_INTERVAL_SECONDS:-10}
      HEARTBEAT_TTL_SECONDS: ${HEARTBEAT_TTL_SECONDS:-30}
      DEFAULT_MAX_CONCURRENCY: ${DEFAULT_MAX_CONCURRENCY:-4}
      LOG_LEVEL: ${LOG_LEVEL:-INFO}
      LOG_FILE: ${LOG_FILE:-}
      NANOBANANA_API_KEY: ${NANOBANANA_API_KEY:-}
    ports:
      - "8000:8000"
    restart: unless-stopped

volumes:
  redis-data:

